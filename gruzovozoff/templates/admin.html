{% extends 'base.html' %}
{% block content %}
<h2>Все заявки</h2>
<form method="get" action="{{ url_for('admin_panel') }}">
    <label>Статус:
        <select name="status">
            <option value="" {% if not status_filter %}selected{% endif %}>Все</option>
            <option value="Новая" {% if status_filter=='Новая' %}selected{% endif %}>Новая</option>
            <option value="В работе" {% if status_filter=='В работе' %}selected{% endif %}>В работе</option>
            <option value="Выполнено" {% if status_filter=='Выполнено' %}selected{% endif %}>Выполнено</option>
            <option value="Отменена" {% if status_filter=='Отменена' %}selected{% endif %}>Отменена</option>
        </select>
    </label>
    <button type="submit">Фильтр</button>
</form>
{% if orders %}
<table>
<tr><th>ID</th><th>Пользователь</th><th>Дата</th><th>Вес</th><th>Габариты</th><th>Тип</th><th>Откуда</th><th>Куда</th><th>Статус</th><th>Действия</th></tr>
{% for o in orders %}
<tr>
<td>{{ o.id }}</td>
<td>{{ o.user_id }}</td>
<td>{{ o.datetime }}</td>
<td>{{ o.weight }}</td>
<td>{{ o.size }}</td>
<td>{{ o.cargo_type }}</td>
<td>{{ o.from_addr }}</td>
<td>{{ o.to_addr }}</td>
<td>{{ o.status }}</td>
<td>
    <form method="post" action="{{ url_for('update_status', order_id=o.id) }}" style="display:inline">
        <select name="status">
            <option value="Новая" {% if o.status=='Новая' %}selected{% endif %}>Новая</option>
            <option value="В работе" {% if o.status=='В работе' %}selected{% endif %}>В работе</option>
            <option value="Выполнено" {% if o.status=='Выполнено' %}selected{% endif %}>Выполнено</option>
            <option value="Отменена" {% if o.status=='Отменена' %}selected{% endif %}>Отменена</option>
        </select>
        <button type="submit">Обновить</button>
    </form>
    <form method="post" action="{{ url_for('delete_order', order_id=o.id) }}" style="display:inline">
        <button type="submit">Удалить</button>
    </form>
</td>
</tr>
{% endfor %}
</table>
{% else %}<p>Заявок нет</p>{% endif %}
{% endblock %}
